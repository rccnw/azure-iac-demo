
The file resource-group-arm.bicep will create 4 resources within an existing resource group. (See below for how it was created)

This will exactly recrate the infrastructure created by the terraform scripts.

TODO:  this bicep code is not parameterized, it needs to be.


Required:

1) resource group exists
2) local bicep file exists (see how to below)
3) same region as resouce group is declared in bicep.



1) If necessary, create a resource group, with the name expected by the bicep for the contained resources. Use 'upwork-test-rg' for example

az group create --name upwork-test-rg --location <REGION>>

2) deploy the resources to the resource group as defined in the bicep file.

az deployment group create --resource-group "upwork-test-rg" --template-file "resource-group-arm.bicep" 




How resource-group-arm.bicep was created

1) The terraform script was run to deploy azure resources. (set vars as required first)
2) In the created Azure resource group, select Automation export template. This displays an ARM script for all the resources in the resource group.
3) copy the ARM script to a local file 'resource-group-arm.json'.
4) perform az decompilation to create bicep file 'resource-group-arm.bicep': 
    
    az bicep decompile --file resource-group-arm.json



===============================================================================





Errors that occured when performing 'Automation/Export Template' in portal  :


function app template export errors:  
(happened when exporting resource group also, which inclided function app)

Could not get resources of the type 'Microsoft.Web/sites/sitecontainers'. 
Resources of this type will not be exported. (Code: ExportTemplateProviderError, Target: Microsoft.Web/sites/sitecontainers)

Could not get resources of the type 'Microsoft.Web/sites/hybridconnection'. 
Resources of this type will not be exported. (Code: ExportTemplateProviderError, Target: Microsoft.Web/sites/hybridconnection)


------------------------------------------------------


Bicep, like ARM templates, does not directly create resource groups because both are designed to deploy resources within an existing resource group. 
The creation of a resource group is typically a step that precedes the deployment of resources within it. 
Here's how you can handle the creation of a resource group and then deploy your Bicep file:


az group create --name upwork-test-rg --location <REGION> 

example:
az group create --name upwork-test-rg --location westus2

az deployment group create --resource-group upwork-test-rg --template-file rg-arm.bicep


az deployment group create --resource-group upwork-test-rg --template-file resource-group-arm.bicep
------------------------------------------------------


az bicep decompile --file resource-group.-arm.json




D:\Dev2024\git-rccnw\azure-iac-demo\bicep>az bicep decompile --file resource-group.-arm.json
WARNING: Decompilation is a best-effort process, as there is no guaranteed mapping from ARM JSON to Bicep Template or Bicep Parameters.
You may need to fix warnings and errors in the generated bicep/bicepparam file(s), or decompilation may fail entirely if an accurate conversion is not possible.
If you would like to report any issues or inaccurate conversions, please see https://github.com/Azure/bicep/issues.



D:\Dev2024\git-rccnw\azure-iac-demo\bicep\resource-group.-arm.bicep(11,5) : Warning BCP073: The property "tier" is read-only. Expressions cannot be assigned to read-only properties. If this is an inaccuracy in the documentation, please report it to the Bicep Team. [https://aka.ms/bicep-type-issues]
D:\Dev2024\git-rccnw\azure-iac-demo\bicep\resource-group.-arm.bicep(96,3) : Warning BCP073: The property "sku" is read-only. Expressions cannot be assigned to read-only properties. If this is an inaccuracy in the documentation, please report it to the Bicep Team. [https://aka.ms/bicep-type-issues]
D:\Dev2024\git-rccnw\azure-iac-demo\bicep\resource-group.-arm.bicep(114,3) : Warning BCP073: The property "sku" is read-only. Expressions cannot be assigned to read-only properties. If this is an inaccuracy in the documentation, please report it to the Bicep Team. [https://aka.ms/bicep-type-issues]
D:\Dev2024\git-rccnw\azure-iac-demo\bicep\resource-group.-arm.bicep(206,3) : Warning BCP187: The property "location" does not exist in the resource or type definition, although it might still be valid. If this is an inaccuracy in the documentation, please report it to the Bicep Team. [https://aka.ms/bicep-type-issues]
D:\Dev2024\git-rccnw\azure-iac-demo\bicep\resource-group.-arm.bicep(215,3) : Warning BCP187: The property "location" does not exist in the resource or type definition, although it might still be valid. If this is an inaccuracy in the documentation, please report it to the Bicep Team. [https://aka.ms/bicep-type-issues]
D:\Dev2024\git-rccnw\azure-iac-demo\bicep\resource-group.-arm.bicep(224,3) : Warning BCP187: The property "location" does not exist in the resource or type definition, although it might still be valid. If this is an inaccuracy in the documentation, please report it to the Bicep Team. [https://aka.ms/bicep-type-issues]
D:\Dev2024\git-rccnw\azure-iac-demo\bicep\resource-group.-arm.bicep(302,3) : Warning BCP187: The property "location" does not exist in the resource or type definition, although it might still be valid. If this is an inaccuracy in the documentation, please report it to the Bicep Team. [https://aka.ms/bicep-type-issues]
D:\Dev2024\git-rccnw\azure-iac-demo\bicep\resource-group.-arm.bicep(312,3) : Warning BCP187: The property "location" does not exist in the resource or type definition, although it might still be valid. If this is an inaccuracy in the documentation, please report it to the Bicep Team. [https://aka.ms/bicep-type-issues]
D:\Dev2024\git-rccnw\azure-iac-demo\bicep\resource-group.-arm.bicep(330,5) : Warning no-unnecessary-dependson: Remove unnecessary dependsOn entry 'storageAccounts_upworkprodstgacctsa_name_resource'. [https://aka.ms/bicep/linter/no-unnecessary-dependson]
D:\Dev2024\git-rccnw\azure-iac-demo\bicep\resource-group.-arm.bicep(346,5) : Warning no-unnecessary-dependson: Remove unnecessary dependsOn entry 'storageAccounts_upworkprodstgacctsa_name_resource'. [https://aka.ms/bicep/linter/no-unnecessary-dependson]
D:\Dev2024\git-rccnw\azure-iac-demo\bicep\resource-group.-arm.bicep(359,5) : Warning no-unnecessary-dependson: Remove unnecessary dependsOn entry 'storageAccounts_upworkprodstgacctsa_name_resource'. [https://aka.ms/bicep/linter/no-unnecessary-dependson]
D:\Dev2024\git-rccnw\azure-iac-demo\bicep\resource-group.-arm.bicep(368,5) : Warning no-unnecessary-dependson: Remove unnecessary dependsOn entry 'storageAccounts_upworkprodstgacctsa_name_resource'. [https://aka.ms/bicep/linter/no-unnecessary-dependson]




Use the az bicep build command with the --file or -f option to specify the path to your Bicep file. 
This command will compile your Bicep file into an ARM template, and if there are any issues with the Bicep file, it will provide error messages.


az bicep build --file <path-to-your-bicep-file>

az bicep build --file resource-group-arm.bicep


Bicep also includes a linter that can provide additional checks 
az bicep lint --file resource-group-arm.bicep



Deploy the Bicep file: Use the az deployment group create command for resource group-level deployments or az deployment sub create for subscription-level deployments. 
For a resource group-level deployment, use:

az deployment group create --resource-group "upwork-test-rg" --template-file "path/to/your/bicepfile.bicep" --parameters @path/to/your/parametersfile.json



az deployment group create --resource-group "upwork-test-rg" --template-file "resource-group-arm.bicep" 



THIS WORKED (APPARENTLY)

az group create --name upwork-test-rg --location westus2
az deployment group create --resource-group "upwork-test-rg" --template-file "resource-group-arm.bicep" 